# ì‹¤í—˜ ìžë™í™” ì‹œìŠ¤í…œ (EEG â€§ ìŠ¬ë¼ì´ë“œ â€§ ì»¨íŠ¸ë¡¤ëŸ¬)

ì´ ë¦¬í¬ì§€í„°ë¦¬ëŠ” **ì„¸ ëŒ€ì˜ PC(A, B, C)** ë¥¼ UDP í”„ë¡œí† ì½œë¡œ ì—°ê²°í•´ ë‡ŒíŒŒ ì‹¤í—˜ì„ ì „ìžë™í™”í•˜ê¸° ìœ„í•œ íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ ëª¨ìŒìž…ë‹ˆë‹¤.

* **A (EEG PC)**Â : Telescan ë…¹í™”Â·ë§ˆì»¤ ìžë™í™”
* **B (ìŠ¬ë¼ì´ë“œ PC)**Â : PowerPoint ìŠ¬ë¼ì´ë“œ ì§„í–‰ ìžë™í™”
* **C (ì»¨íŠ¸ë¡¤ëŸ¬ PC)**Â : ì‹œë‚˜ë¦¬ì˜¤ íƒ€ì´ë¨¸ + Pygame ìƒíƒœì°½ + UDP ë¸Œë¡œë“œìºìŠ¤íŠ¸

---

## ðŸ“‚ ë””ë ‰í„°ë¦¬ êµ¬ì¡°

```text
experiment/
â”œâ”€ config.py          # IPÂ·í¬íŠ¸Â·íŒŒì¼ ê²½ë¡œ ë“± ì¤‘ì•™ ì„¤ì •
â”œâ”€ scenario.yaml      # ì‹¤í—˜ ë‹¨ê³„Â·ì‹œê°„Â·ëª…ë ¹ ì •ì˜ íŒŒì¼
â”œâ”€ controller.py      # CÂ â€“Â íƒ€ì´ë¨¸ & ë¸Œë¡œë“œìºìŠ¤íŠ¸
â”œâ”€ eeg_client.py      # AÂ â€“Â Telescan ìžë™ì œì–´
â”œâ”€ slide_client.py    # BÂ â€“Â PowerPoint ìžë™ì œì–´
â””â”€ logs/              # ê° PCê°€ ìƒì„±í•˜ëŠ” CSV ë¡œê·¸ í´ë”
```

---

## ðŸ”§ ìš”êµ¬ ì‚¬í•­

| í•­ëª©       | ë²„ì „/ë¹„ê³                                                     |
| -------- | -------------------------------------------------------- |
| Python   | 3.10 ì´ìƒ (WindowsÂ 10/11Â í…ŒìŠ¤íŠ¸ ì™„ë£Œ)                           |
| ë¼ì´ë¸ŒëŸ¬ë¦¬    | `pygame`, `pyyaml`, `pyautogui`, `pyperclip`                |
| ë„¤íŠ¸ì›Œí¬     | TPâ€‘Link ê³µìœ ê¸° í™˜ê²½, **UDPÂ í¬íŠ¸ 4210** í—ˆìš©                       |
| ë‡ŒíŒŒ ì†Œí”„íŠ¸ì›¨ì–´ | Telescan (ë‹¨ì¶•í‚¤: ìƒˆ ì„¸ì…˜Â `Ctrl+N`, ë…¹í™”Â `F5`, ì •ì§€Â `F6`, ë§ˆì»¤Â `F9`) |
| ìŠ¬ë¼ì´ë“œ     | PowerPoint (ìŠ¬ë¼ì´ë“œ ì‡¼ ì‹œìž‘Â `F5`, ì¢…ë£ŒÂ `Esc`, ë‹¤ìŒÂ `â†’`, ì´ì „Â `â†`)    |

> ðŸ›ˆÂ ë‹¨ì¶•í‚¤Â·í¬íŠ¸Â·IP ì£¼ì†ŒëŠ” ì—°êµ¬ì‹¤ í™˜ê²½ì— ë§žì¶° **`config.py`** ë˜ëŠ” ê° ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì—ì„œ ë°˜ë“œì‹œ ìˆ˜ì •í•˜ì„¸ìš”.

---

## ðŸš€ ì„¤ì¹˜

```bash
# ì„¸ ëŒ€ì˜ PC ëª¨ë‘ ë™ì¼
pip install -r requirements.txt
```

- requirements.txtì—ëŠ” ì‹¤í—˜ ìžë™í™”ì— í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬(`pyautogui`, `pyperclip`, `pyyaml`)ê°€ í¬í•¨ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.
- í•œê¸€ íŒŒì¼ëª…/í´ë”ëª… ìžë™ ìž…ë ¥ì„ ìœ„í•´ `pyperclip`ì´ í•„ìˆ˜ë¡œ í•„ìš”í•©ë‹ˆë‹¤.

1. **ê³ ì •Â IP**Â :Â `config.py` ì˜ `A_IP`, `B_IP` ê°’ì„ ê° PC ì£¼ì†Œë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
2. **ë°©í™”ë²½**Â :Â TCP/UDP 4210 í¬íŠ¸ë¥¼ ì¸ë°”ìš´ë“œë¡œ í—ˆìš©í•©ë‹ˆë‹¤.
3. **Telescanâ€†/â€†PowerPoint ë‹¨ì¶•í‚¤**Â :Â ì—°êµ¬ì‹¤ í‚¤ë§µê³¼ ë‹¤ë¥´ë©´ `eeg_client.py`,Â `slide_client.py` ì˜ í•¨ìˆ˜ë“¤ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.

---

## â–¶ï¸ ì‹¤í–‰ ìˆœì„œ

| ë‹¨ê³„ | PC    | ëª…ë ¹                       |
| -- | ----- | ------------------------ |
| 1  | **A** | `python eeg_client.py`   |
| 2  | **B** | `python slide_client.py` |
| 3  | **C** | `python controller.py`   |

> `controller.py` ëŠ” ê¸°ë³¸ìœ¼ë¡œ `scenario.yaml` ì„ ì½ì–´ íƒ€ì´ë¨¸ë¥¼ ì‹œìž‘í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤ íŒŒì¼ì„ ì“°ë ¤ë©´ `python controller.py --file custom.yaml` ê³¼ ê°™ì´ ì˜µì…˜ì„ ì£¼ë©´ ë©ë‹ˆë‹¤.

ì‹¤í–‰ì´ ì‹œìž‘ë˜ë©´ C PCÂ í™”ë©´ì— **ì§„í–‰ ë‹¨ê³„ + ë‚¨ì€ ì‹œê°„** ì´ Pygame ì°½ìœ¼ë¡œ í‘œì‹œë˜ê³ , AÂ·BÂ PC ëŠ” ìˆ˜ì‹ í•œ ëª…ë ¹ì— ë”°ë¼ ìžë™ ë™ìž‘í•©ë‹ˆë‹¤.

---

## ðŸ“ ì‹œë‚˜ë¦¬ì˜¤ íŽ¸ì§‘Â (`scenario.yaml`)

```yaml
# name : ë‹¨ê³„ ì´ë¦„ (ì˜ˆ: "1. ì„ íƒì§€1" ë“±, íšŒì°¨ì™€ ë‹¨ê³„ëª… ìžë™ ì¶”ì¶œ)
# dur  : ì´ˆ ë‹¨ìœ„ ì§€ì†ì‹œê°„(ì‹¤ìˆ˜ ê°€ëŠ¥)
# send : [ëŒ€ìƒ:ëª…ë ¹, ...]  ëŒ€ìƒÂ A=EEGÂ PC, B=ìŠ¬ë¼ì´ë“œÂ PC
- { name: "1. ì‹œë‚˜ë¦¬ì˜¤", dur: 30, send: [A:REC_ON:choice1, B:NEXT] }
- { name: "1. ì„ íƒì§€1",  dur: 15, send: [A:REC_ON:choice1, B:NEXT] }
- { name: "1. ê³ ì •ì£¼ì‹œ1", dur: 2,  send: [A:REC_OFF, B:NEXT] }
- { name: "2. ì‹œë‚˜ë¦¬ì˜¤", dur: 30, send: [A:REC_ON:choice1, B:NEXT] }
- { name: "2. ì„ íƒì§€1",  dur: 15, send: [A:REC_ON:choice1, B:NEXT] }
- { name: "2. ê³ ì •ì£¼ì‹œ1", dur: 2,  send: [A:REC_OFF, B:NEXT] }
# ... ì´í•˜ ë°˜ë³µ ...
```

* **ëª…ë ¹ ëª©ë¡**

  * `A`Â : `REC_ON`, `REC_OFF`, `MARK_RESP` *(ì§ì ‘ ì¶”ê°€ ê°€ëŠ¥)*
  * `B`Â : `SHOW_START`, `SHOW_END`, `NEXT`, `PREV`
* ë‹¨ê³„ëŠ” ì›í•˜ëŠ” ë§Œí¼ ì¶”ê°€Â·ì‚­ì œí•  ìˆ˜ ìžˆìœ¼ë©°, `dur` ê°’ìœ¼ë¡œ ì •í™•í•œ íƒ€ì´ë°ì„ ì œì–´í•©ë‹ˆë‹¤.
* **ë‹¨ê³„ ì´ë¦„(name)ì—ì„œ íšŒì°¨ì™€ ì£¼ìš” í‚¤ì›Œë“œëŠ” ìžë™ ì¶”ì¶œë˜ì–´ íŒŒì¼ëª…ì— ë°˜ì˜ë©ë‹ˆë‹¤.**

---

## âš™ï¸ ì»¤ìŠ¤í„°ë§ˆì´ì§• íŒ

| í•„ìš” ê¸°ëŠ¥             | ìˆ˜ì • ìœ„ì¹˜                                                           |
| ----------------- | --------------------------------------------------------------- |
| í¬íŠ¸ ë°”ê¾¸ê¸°            | `config.py` â†’ `PORT`                                            |
| ì‹¤í—˜ ì¤‘ ì¶”ê°€ ë§ˆì»¤ ì „ì†¡     | `scenario.yaml` ì— `A:MARK_XXX` í–‰ ì¶”ê°€ í›„ `eeg_client.py` ì— í•¨ìˆ˜ ë§¤í•‘   |
| ìŠ¬ë¼ì´ë“œ ëŒ€ì‹  ìžì²´ GUI ì‚¬ìš© | `slide_client.py` ë¥¼ êµì²´í•˜ê±°ë‚˜ `pygame` ê¸°ë°˜ìœ¼ë¡œ ìž¬ìž‘ì„±                     |
| ì§„í–‰ë¥  ë°”Â·ì•Œë¦¼ìŒ         | `controller.py` ì˜ Pygame ë£¨í”„ì—ì„œ êµ¬í˜„                                |
| UDP ìž¬ì „ì†¡(íŒ¨í‚· ìœ ì‹¤ ëŒ€ë¹„) | `controller.py` â†’ `send()` í•¨ìˆ˜ì— `for _ in range(3):` ê°™ì€ ë°˜ë³µ ì „ì†¡ ì¶”ê°€ |

---

## ðŸ› ï¸ ë¬¸ì œ í•´ê²°

| ì¦ìƒ                   | ì›ì¸/í•´ê²°                                                            |
| -------------------- | ---------------------------------------------------------------- |
| Pygame ì°½ì´ í•œê¸€ ê¹¨ì§      | ì‹œìŠ¤í…œì— **NanumGothic** í°íŠ¸ ì„¤ì¹˜ í›„ `FONT` ì„¤ì • ë³€ê²½                        |
| ëª…ë ¹ì´ ìˆ˜ì‹ ë˜ì§€ ì•ŠìŒ          | â‘ Â ë°©í™”ë²½ í¬íŠ¸Â 4210Â í—ˆìš© ì—¬ë¶€ í™•ì¸ â‘¡Â `config.py` IP ì˜¤íƒ€?                      |
| Telescan ì°½ì´ í™œì„±í™”ë˜ì§€ ì•ŠìŒ | `eeg_client.py` ì²« ì¤„ì— `pyautogui.hotkey("alt","tab")` ë“± í¬ì»¤ìŠ¤ ì´ë™ ì¶”ê°€ |
| ìŠ¬ë¼ì´ë“œê°€ ë„˜ì–´ê°€ì§€ ì•ŠìŒ        | PowerPoint ìŠ¬ë¼ì´ë“œ ì‡¼ ëª¨ë“œ(`F5`)ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸                            |
| í•œê¸€ íŒŒì¼ëª…/í´ë”ëª… ìž…ë ¥ ì•ˆ ë¨   | `pyperclip` ë¯¸ì„¤ì¹˜ ì‹œ `pip install pyperclip` ì‹¤í–‰, ë˜ëŠ” requirements.txt ì‚¬ìš© |

---

## ðŸ“œ ë¼ì´ì„ ìŠ¤

MITÂ License â€“ ìžìœ ë¡­ê²Œ ìˆ˜ì •/ìž¬ë°°í¬ ê°€ëŠ¥. ë‹¤ë§Œ ì‹¤ì œ ì‹¤í—˜ì— ì ìš©í•˜ê¸° ì „ **ì•ˆì „ì„± í…ŒìŠ¤íŠ¸** ë¥¼ ì¶©ë¶„ížˆ ì§„í–‰í•˜ì„¸ìš”.

> Â©Â 2025Â Kangwon Science High SchoolÂ BCIÂ Lab /Â Author: Eunwoo Chae & Contributors
